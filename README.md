# КЭДО

## Описание примера

Пример включает следующие компоненты: 
- Data > SolutionKEDO.sol - решение, добавляющее в систему Docsvision новые виды ... 
- Data > KEDOSolution - папка с решением, включающим разметки ...
- Data >  - артефакты серверного расширения Web-клиента ... 
- Data >  - артефакты расширения для Конструктора разметок ...

  *С кодом расширений можно ознакомиться перейдя по [ссылке](https://ddsm-gitlab.digdes.com/dv/web-client/samples/-/tree/develop/Controls/SampleCustomTables).*
  
  <!---
  Todo:
  * запушить 
    * решения из МР и КР
	* собранные расширения
  * обновить раздел Описание примера, добавить подробности
  -->

## Проверка примера

1. Установить на стенд решение "ЛК КЭДО" из Менеджера Решений.

Компоненты данного решения:
Справочник видов: Документ - Кадровый документ, Задание - на подписание кэдо
Общие роли: Сотрудник ЛК КЭДО
Метаданные: Кадровые документы
Конструктор Нумерации: Кадровый документ
Конструктор справочников: Кадровые документы, Заявка сотрудника
Поиск: кэдо и все вложенные (Мои задания на ознакомление, Мои задания на подписание, Мои кадровые документы, Поиск кадровых документов, Мои заявки, Заявки для HR)
Представление: кэдо -> "Документы дашборда","Документы лк кэдо", "Задания кэдо", "Заявки лк кэдо", "Заявки лк кэдо дашборд", "Заявки лк кэдо для HR"
Папки: "КЭДО" - все подчиненные,внутри папки маршруты согласования. "КЭДО кадровика"



После переноса решения из Менеджера решений:
2. Компоненты для сервера Web-клиент - скрипты и расширения.

   1. Скопируйте содержимое папки `Modules` в  `<Каталог установки Web-клиента>\Site\Content\Modules`.
   2. Перезапустите IIS.


3. Загрузить Решение "КЭДО"  в конструктор веб-разметок. Должны появиться:
а)Webframe
1.1 корень веб-фрейм
1.2 главная страница
1.3 диалог профиля пользователя
б)backoffice
1.1 Документ - Кадровый документ, заявка сотрудника
1.2 Задание КС - На согласование, На подписание КЭДО
1.3 Задание УД - На ознакомление

4. Настройка решения.
По задаче TSK-4692 Убрать в подписи метку и настройки для лк кэдо
- Открыть папку SignatureWebExtension во встроенном терминале и выполнить команду npm i.
- Готовое расширение скопировать из папки SignatureWebExtension/Dist/Site/Content/Modules и поместить в `<Каталог установки Web-клиента>\Site\Content\Modules`.
- В Конструкторе Разметок открыть разметку страницы где будет происходить подписание.
- В структуре карточке выбрать documentRoot и в событие "После загрузки всех ЭУ" прописать(без кавычек) "signature".
- Перезапустить IIS


  <!---
  Todo:
  * актуализировать, пока добавлено, что есть на текущий момент
  -->
  # CustomTables

Этот каталог содержит пример реализации элемента управления "CustomTables".

## Описание контрола "SampleCustomTables"

Контрол "SampleCustomTables" содержит базовый функционал контрола "Виджет / Карточки папки" ("FolderCardsDashboardWidget") с дополнительными параметрами: изменение наименования ссылки под таблицей, добавление счетчика документов / заданий / заявок и дополнительную кнопку с заданной ссылкой и наименованием.

## Настройка среды

**Перечень необходимых инструментов:** 
* [Visual Studio 2022](https://www.visualstudio.com)
* [NodeJS v14.17.0+](https://nodejs.org/en/)

## Сборка и установка

1. Открыть /Samples.sln
2. Собрать проект Controls > SampleCustomTables > CustomTablesDesignerExtension
3. Открыть консоль в папке Controls > CustomTables > CustomTablesWebExtension и выполнить команду `npm install` и `npm run build`
4. Скопировать содержимое из Controls > CustomTables > CustomTablesDesignerExtension > xml  в каталог "Путь к установленному Web-клиент\Plugins"
5. Скопировать содержимое из Controls > CustomTables > CustomTablesDesignerExtension > bin > Plugins в каталог "Путь к установленному Web-клиент\Plugins"
6. Скопировать каталог SamplesOutput\Site\Content\Modules\SampleCustomTables в каталог "Путь к установленному Web-клиенту\Site\Content\Modules"
7. Перезапустить IIS

## Проверка примера

1. Запустить конструктор разметок
2. Скопировать разметку в своё решение, изменить условие выбора разметки и добавить в разметку новый элемент управления "SampleCustomTables"
3. Задать желаемые параметры элемента управления:
    - Наименование ссылки под таблицей: наименование ссылки, расположенной под таблицей и ведущей на страницу папки, к которой подключен контрол. По умолчанию наименование - "Ещё"
    - Скрыть кнопку: управление видимостью дополнительной кнопки над таблицей. По умолчанию кнопка скрыта
    - Текст кнопки: наименование дополнительной кнопки над таблицей
    - Ссылка кнопки: ссылка, по которой будет осуществлен переход после нажатия кнопки
    - Скрыть счетчик: управление видимостью счетчика, показывающего количество документов / заданий / заявок в подключенной папке. По умолчанию счетчик скрыт
    - Скрыть таблицу: управление видимостью таблицы. По умолчанию таблица не скрыта
    - Количество карточек: максимальное количество карточек (строк), отображаемых в таблице
    - Папка: ID папки, к которой необходимо подключить контрол
    - Представление: ID представления для отображения нужных в таблице колонок
4. Сохранить разметку
5. Перезапустить IIS
8. Открыть главную страницу
9. Убедиться, что появился новый элемент управления

## Проект SampleCustomTablesWebExtension

Проект-расширение клиентской части Web-клиента. Содержит клиентский скрипт и стили для элемента управления "SampleCustomTables".

## Проект SampleCustomTablesDesignerExtension

Проект-расширение для Конструктора разметок. Содержит описание элемента управления "SampleCustomTables".